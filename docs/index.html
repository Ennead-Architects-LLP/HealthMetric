<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthMetric Dashboard - Ennead Architects</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <link rel="stylesheet" href="styles/components/hero.css">
</head>
<body>
    <!-- Hero Section -->
    <section class="hero" id="hero">
        <!-- Background Slideshow -->
        <div class="hero-slideshow">
            <div class="slide slide-1 active" style="background-image: url('https://design-middleeast.com/wp-content/uploads/2021/11/Shanghai-Astronomy-Museum-Ennead-Architects-1.jpg');"></div>
            <div class="slide slide-2" style="background-image: url('https://www.archdaily.com/wp-content/uploads/2022/06/1655122012-archdaily-milwaukee-public-museum-ennead-architects-kahler-slater-01.jpg');"></div>
            <div class="slide slide-3" style="background-image: url('https://natrealestatedevelopment.com/wp-content/uploads/2023/05/Jefferson-Health-Honickman-Center-Ennead-Architects-1.jpg');"></div>
        </div>
        
        <!-- Flying Items Container -->
        <div class="flying-container"></div>
        
        <!-- Hero Content -->
        <div class="hero-content">
            <h1 class="hero-title fade-in">HealthMetric Dashboard</h1>
            <p class="hero-subtitle fade-in stagger-1">Architectural Project Analytics & Performance Tracking</p>
            
            <!-- Metrics Grid -->
            <div class="metrics-grid fade-in stagger-2">
                <div class="metric-card">
                    <div class="metric-value" id="totalProjects">-</div>
                    <div class="metric-label">Total Projects</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="totalElements">-</div>
                    <div class="metric-label">Total Elements</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="totalViews">-</div>
                    <div class="metric-label">Total Views</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="totalWarnings">-</div>
                    <div class="metric-label">Total Warnings</div>
                </div>
            </div>
            
            <!-- Enter Dashboard Button -->
            <button class="enter-dashboard-btn fade-in stagger-3" id="enterDashboardBtn">
                Enter Dashboard
            </button>
        </div>
        
        <!-- Ennead Architects Branding -->
        <div class="ennead-branding">
            <div class="ennead-logo">Ennead Architects LLP</div>
            <div class="ennead-powered">Powered by EnneadTab</div>
        </div>
        
        <!-- Loading State -->
        <div class="hero-loading hidden" id="heroLoading">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading Dashboard Data...</div>
        </div>
    </section>

    <!-- JavaScript -->
    <script>
        // Simple Hero Animations without ES6 modules
        class HeroAnimations {
            constructor() {
                this.flyingItems = [];
                this.mousePosition = { x: 0, y: 0 };
                this.isMouseMoving = false;
                this.mouseTimeout = null;
                this.maxItems = 30;
                this.animationId = null;
                this.isActive = false;
                this.dashboardData = null;
                this.isDashboardPreloaded = false;
                
                this.projectNames = [
                    'Healthcare Starter Template',
                    '1643_LHH - Existing',
                    '1643_LHH - New',
                    '1643_LHH ULURP BASE Scheme D',
                    'Lines and Fills',
                    'TEMP - L1 - Ambulance Drive Thru',
                    'TEMP - Programming Plans'
                ];
                
                this.hubNames = ['Ennead Architects LLP'];
                this.init();
                this.startItemSpawning();
            }
            
            startItemSpawning() {
                // Spawn new items periodically to fill screen over time
                setInterval(() => {
                    if (this.flyingItems.length < this.maxItems * 2) {
                        this.addRandomItem();
                    }
                }, 3000); // Add new item every 3 seconds
            }
            
            async preloadDashboardData() {
                console.log('🔄 Preloading dashboard data...');
                try {
                    // Simulate loading dashboard data (same as dashboard.html)
                    this.dashboardData = [
                        {
                            hubName: 'Ennead Architects LLP',
                            projectName: '1643_LHH',
                            modelName: '1643_LHH - Existing',
                            timestamp: new Date('2025-10-02T18:05:56.334000'),
                            totalElements: 18373,
                            totalViews: 100,
                            totalSheets: 5,
                            totalFamilies: 63,
                            totalRooms: 0,
                            warningCount: 62,
                            criticalWarningCount: 0,
                            viewsNotOnSheets: 72,
                            copiedViews: 95,
                            dimensions: 822,
                            materials: 74,
                            executionTime: 6.65,
                            revitVersion: '2024',
                            jobId: 'job_20251002_180536_6',
                            isEnneadTabAvailable: true,
                            status: 'completed',
                            filename: '1643_LHH - Existing.SexyDuck',
                            parsedAt: new Date(),
                            format: 'SexyDuck'
                        },
                        {
                            hubName: 'Ennead Architects LLP',
                            projectName: '1643_LHH',
                            modelName: '1643_LHH - New',
                            timestamp: new Date('2025-10-02T18:05:53.430000'),
                            totalElements: 15230,
                            totalViews: 85,
                            totalSheets: 4,
                            totalFamilies: 0,
                            totalRooms: 0,
                            warningCount: 45,
                            criticalWarningCount: 0,
                            viewsNotOnSheets: 65,
                            copiedViews: 80,
                            dimensions: 650,
                            materials: 58,
                            executionTime: 5.23,
                            revitVersion: '2024',
                            jobId: 'job_20251002_180536_5',
                            isEnneadTabAvailable: true,
                            status: 'completed',
                            filename: '1643_LHH - New.SexyDuck',
                            parsedAt: new Date(),
                            format: 'SexyDuck'
                        },
                        {
                            hubName: 'Ennead Architects LLP',
                            projectName: '1643_LHH',
                            modelName: 'Lines and Fills',
                            timestamp: new Date('2025-10-02T18:05:53.430000'),
                            totalElements: 8930,
                            totalViews: 45,
                            totalSheets: 2,
                            totalFamilies: 0,
                            totalRooms: 0,
                            warningCount: 12,
                            criticalWarningCount: 0,
                            viewsNotOnSheets: 38,
                            copiedViews: 42,
                            dimensions: 320,
                            materials: 25,
                            executionTime: 3.89,
                            revitVersion: '2024',
                            jobId: 'job_20251002_180536_4',
                            isEnneadTabAvailable: true,
                            status: 'completed',
                            filename: 'Lines and Fills.SexyDuck',
                            parsedAt: new Date(),
                            format: 'SexyDuck'
                        },
                        {
                            hubName: 'Ennead Architects LLP',
                            projectName: '1643_LHH',
                            modelName: 'TEMP - L1 - Ambulance Drive Thru',
                            timestamp: new Date('2025-10-02T18:05:53.430000'),
                            totalElements: 5670,
                            totalViews: 35,
                            totalSheets: 2,
                            totalFamilies: 0,
                            totalRooms: 0,
                            warningCount: 8,
                            criticalWarningCount: 0,
                            viewsNotOnSheets: 28,
                            copiedViews: 32,
                            dimensions: 180,
                            materials: 15,
                            executionTime: 2.45,
                            revitVersion: '2024',
                            jobId: 'job_20251002_180536_3',
                            isEnneadTabAvailable: true,
                            status: 'completed',
                            filename: 'TEMP - L1 - Ambulance Drive Thru.SexyDuck',
                            parsedAt: new Date(),
                            format: 'SexyDuck'
                        },
                        {
                            hubName: 'Ennead Architects LLP',
                            projectName: '1643_LHH',
                            modelName: 'TEMP - Programming Plans',
                            timestamp: new Date('2025-10-02T18:05:53.430000'),
                            totalElements: 4230,
                            totalViews: 25,
                            totalSheets: 1,
                            totalFamilies: 0,
                            totalRooms: 0,
                            warningCount: 5,
                            criticalWarningCount: 0,
                            viewsNotOnSheets: 18,
                            copiedViews: 22,
                            dimensions: 120,
                            materials: 10,
                            executionTime: 1.89,
                            revitVersion: '2024',
                            jobId: 'job_20251002_180536_2',
                            isEnneadTabAvailable: true,
                            status: 'completed',
                            filename: 'TEMP - Programming Plans.SexyDuck',
                            parsedAt: new Date(),
                            format: 'SexyDuck'
                        }
                    ];
                    
                    // Store in sessionStorage for dashboard to use
                    sessionStorage.setItem('dashboardData', JSON.stringify(this.dashboardData));
                    this.isDashboardPreloaded = true;
                    console.log('✅ Dashboard data preloaded successfully');
                    
                    // Update metrics on hero page
                    this.updateHeroMetrics();
                    
                } catch (error) {
                    console.error('❌ Failed to preload dashboard data:', error);
                }
            }
            
            updateHeroMetrics() {
                if (!this.dashboardData) return;
                
                const totalProjects = new Set(this.dashboardData.map(item => item.projectName)).size;
                const totalElements = this.dashboardData.reduce((sum, item) => sum + item.totalElements, 0);
                const totalViews = this.dashboardData.reduce((sum, item) => sum + item.totalViews, 0);
                const totalWarnings = this.dashboardData.reduce((sum, item) => sum + item.warningCount, 0);
                
                document.getElementById('totalProjects').textContent = totalProjects;
                document.getElementById('totalElements').textContent = totalElements.toLocaleString();
                document.getElementById('totalViews').textContent = totalViews.toLocaleString();
                document.getElementById('totalWarnings').textContent = totalWarnings;
                
                // Add visual indicator that data is ready
                const enterBtn = document.getElementById('enterDashboardBtn');
                if (enterBtn) {
                    enterBtn.style.background = 'linear-gradient(135deg, var(--accent-green-light) 0%, var(--accent-green-dark) 100%)';
                    enterBtn.style.boxShadow = '0 4px 20px rgba(0, 255, 136, 0.4)';
                    enterBtn.innerHTML = '🚀 Enter Dashboard (Ready)';
                }
            }
            
            addRandomItem() {
                const container = document.querySelector('.flying-container');
                if (!container) return;
                
                const item = this.createFlyingItem();
                container.appendChild(item);
                
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 0.6 + 0.1; // Slower speed for new items (0.1-0.7)
                
                const newItem = {
                    element: item,
                    x: Math.random() * (window.innerWidth + 100) - 50,
                    y: Math.random() * (window.innerHeight + 100) - 50,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    targetX: 0,
                    targetY: 0,
                    state: 'random',
                    opacity: Math.random() * 0.7 + 0.1,
                    chaosSeed: Math.random()
                };
                
                this.flyingItems.push(newItem);
            }
            
            init() {
                this.createFlyingItems();
                this.bindEvents();
                this.startAnimation();
                this.preloadDashboardData();
            }
            
            createFlyingItems() {
                const container = document.querySelector('.flying-container');
                if (!container) return;
                
                container.innerHTML = '';
                this.flyingItems = [];
                
                    for (let i = 0; i < this.maxItems; i++) {
                        const item = this.createFlyingItem();
                        container.appendChild(item);
                        
                        // Create completely random initial velocities (slower)
                        const angle = Math.random() * Math.PI * 2;
                        const speed = Math.random() * 0.8 + 0.1; // Much slower initial speeds (0.1-0.9)
                        
                        this.flyingItems.push({
                            element: item,
                            x: Math.random() * (window.innerWidth + 100) - 50, // Start beyond screen edges
                            y: Math.random() * (window.innerHeight + 100) - 50,
                            vx: Math.cos(angle) * speed,
                            vy: Math.sin(angle) * speed,
                            targetX: 0,
                            targetY: 0,
                            state: 'random',
                            opacity: Math.random() * 0.7 + 0.1,
                            chaosSeed: Math.random() // Random seed for unique behavior
                        });
                    }
            }
            
            createFlyingItem() {
                const item = document.createElement('div');
                item.className = 'flying-item';
                
                const isProject = Math.random() > 0.3;
                const names = isProject ? this.projectNames : this.hubNames;
                const name = names[Math.floor(Math.random() * names.length)];
                
                item.textContent = name;
                item.style.left = Math.random() * window.innerWidth + 'px';
                item.style.top = Math.random() * window.innerHeight + 'px';
                item.style.opacity = Math.random() * 0.5 + 0.3;
                
                return item;
            }
            
            bindEvents() {
                document.addEventListener('mousemove', (e) => {
                    this.mousePosition.x = e.clientX;
                    this.mousePosition.y = e.clientY;
                    this.isMouseMoving = true;
                    
                    if (this.mouseTimeout) {
                        clearTimeout(this.mouseTimeout);
                    }
                    
                    this.mouseTimeout = setTimeout(() => {
                        this.isMouseMoving = false;
                    }, 100);
                });
                
                window.addEventListener('resize', () => {
                    this.handleResize();
                });
            }
            
            startAnimation() {
                if (this.animationId) return;
                this.isActive = true;
                this.animate();
            }
            
            animate() {
                if (!this.isActive) return;
                
                this.flyingItems.forEach((item, index) => {
                    this.updateFlyingItem(item, index);
                });
                
                this.animationId = requestAnimationFrame(() => this.animate());
            }
            
            updateFlyingItem(item, index) {
                const element = item.element;
                
                if (this.isMouseMoving) {
                    this.attractToMouse(item);
                } else {
                    this.randomFloat(item);
                }
                
                    item.x += item.vx;
                    item.y += item.vy;

                    // Wrap around screen edges to fill entire screen over time
                    if (item.x < -50) {
                        item.x = window.innerWidth + 50;
                    }
                    if (item.x > window.innerWidth + 50) {
                        item.x = -50;
                    }
                    if (item.y < -50) {
                        item.y = window.innerHeight + 50;
                    }
                    if (item.y > window.innerHeight + 50) {
                        item.y = -50;
                    }
                
                element.style.left = item.x + 'px';
                element.style.top = item.y + 'px';
                element.style.opacity = item.opacity;
                element.className = `flying-item ${item.state}`;
            }
            
            attractToMouse(item) {
                const dx = this.mousePosition.x - item.x;
                const dy = this.mousePosition.y - item.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 200) {
                    const force = 0.02;
                    item.vx += dx * force;
                    item.vy += dy * force;
                    item.state = 'attracted';
                    item.opacity = Math.min(1, 0.5 + (200 - distance) / 200 * 0.5);
                } else {
                    const force = 0.01;
                    item.vx += dx * force;
                    item.vy += dy * force;
                    item.state = 'following';
                    item.opacity = 0.7;
                }
                
                item.vx *= 0.98;
                item.vy *= 0.98;
                
                const maxVelocity = 2;
                const velocity = Math.sqrt(item.vx * item.vx + item.vy * item.vy);
                if (velocity > maxVelocity) {
                    item.vx = (item.vx / velocity) * maxVelocity;
                    item.vy = (item.vy / velocity) * maxVelocity;
                }
            }
            
            randomFloat(item) {
                // Create truly chaotic random movement
                const time = Date.now() * 0.001;
                const itemId = this.flyingItems.indexOf(item);
                
                // Multiple independent random forces for true chaos
                const chaosLevel = 0.015; // Reduced base chaos level for slower movement
                const randomMultiplier = 0.3 + Math.random() * 0.7; // Reduced random intensity
                
                // Force 1: Random direction changes (most important) - reduced frequency
                if (Math.random() < 0.15) { // 15% chance each frame (was 40%)
                    const angle = Math.random() * Math.PI * 2;
                    const force = chaosLevel * randomMultiplier * (0.2 + Math.random() * 0.4);
                    item.vx += Math.cos(angle) * force;
                    item.vy += Math.sin(angle) * force;
                }
                
                // Force 2: Completely random acceleration - reduced frequency
                if (Math.random() < 0.1) { // 10% chance (was 30%)
                    item.vx += (Math.random() - 0.5) * chaosLevel * 1.2;
                    item.vy += (Math.random() - 0.5) * chaosLevel * 1.2;
                }
                
                // Force 3: Perpendicular forces (creates circular motion) - reduced frequency
                if (Math.random() < 0.08) { // 8% chance (was 20%)
                    const currentAngle = Math.atan2(item.vy, item.vx);
                    const perpendicularAngle = currentAngle + (Math.random() - 0.5) * Math.PI;
                    const force = chaosLevel * 0.3;
                    item.vx += Math.cos(perpendicularAngle) * force;
                    item.vy += Math.sin(perpendicularAngle) * force;
                }
                
                // Force 4: Random velocity resets (sudden direction changes) - reduced frequency
                if (Math.random() < 0.03) { // 3% chance (was 10%)
                    const newAngle = Math.random() * Math.PI * 2;
                    const newSpeed = 0.2 + Math.random() * 0.6;
                    item.vx = Math.cos(newAngle) * newSpeed;
                    item.vy = Math.sin(newAngle) * newSpeed;
                }
                
                // Force 5: Random turbulence (constant small changes) - reduced intensity
                item.vx += (Math.random() - 0.5) * chaosLevel * 0.15;
                item.vy += (Math.random() - 0.5) * chaosLevel * 0.15;
                
                // Force 6: Time-based random forces (different each second) - reduced frequency
                const timeBasedAngle = (time * 0.3 + itemId) % (Math.PI * 2);
                if (Math.random() < 0.05) { // 5% chance (was 15%)
                    const timeForce = Math.sin(time * 2 + itemId) * chaosLevel * 0.2;
                    item.vx += Math.cos(timeBasedAngle) * timeForce;
                    item.vy += Math.sin(timeBasedAngle) * timeForce;
                }
                
                // Minimal friction to keep them moving
                item.vx *= 0.998;
                item.vy *= 0.998;

                // Variable speed limits (slower movement)
                const maxVelocity = 0.6 + Math.random() * 0.4; // Much slower max speed (0.6-1.0)
                const velocity = Math.sqrt(item.vx * item.vx + item.vy * item.vy);
                if (velocity > maxVelocity) {
                    item.vx = (item.vx / velocity) * maxVelocity;
                    item.vy = (item.vy / velocity) * maxVelocity;
                }
                
                // Ensure minimum movement (prevent getting stuck) - slower minimum
                const minVelocity = 0.1 + Math.random() * 0.15;
                if (velocity < minVelocity) {
                    const angle = Math.random() * Math.PI * 2;
                    const speed = minVelocity + Math.random() * 0.2;
                    item.vx = Math.cos(angle) * speed;
                    item.vy = Math.sin(angle) * speed;
                }
                
                item.state = 'random';
                item.opacity = 0.1 + Math.random() * 0.6; // More random opacity
            }
            
            handleResize() {
                this.flyingItems.forEach(item => {
                    if (item.x > window.innerWidth) item.x = window.innerWidth - 100;
                    if (item.y > window.innerHeight) item.y = window.innerHeight - 100;
                });
            }
        }
        
        // Initialize Hero Page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize hero animations
            const heroAnimations = new HeroAnimations();
            
            // Initialize slideshow with Ennead Architects projects
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            console.log('🎬 Initializing slideshow with', slides.length, 'slides');
            
            // Ensure first slide is visible
            if (slides.length > 0) {
                slides[0].classList.add('active');
                console.log('✅ First slide activated');
            }
            
            const slideInterval = setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
                console.log('🔄 Switched to slide', currentSlide + 1);
            }, 6000); // 6 seconds per slide to showcase each project
            
            // Load and display metrics
            loadMetrics();
            
            // Handle dashboard button click
            document.getElementById('enterDashboardBtn').addEventListener('click', function() {
                document.getElementById('heroLoading').classList.remove('hidden');
                document.body.classList.add('screen-wipe');
                setTimeout(() => {
                    window.location.href = 'dashboard.html';
                }, 1500);
            });
            
            // Load metrics from data files
            function loadMetrics() {
                try {
                    const mockData = {
                        totalProjects: 7,
                        totalElements: 16275,
                        totalViews: 277,
                        totalWarnings: 0
                    };
                    
                    animateNumber('totalProjects', mockData.totalProjects);
                    animateNumber('totalElements', mockData.totalElements);
                    animateNumber('totalViews', mockData.totalViews);
                    animateNumber('totalWarnings', mockData.totalWarnings);
                    
                } catch (error) {
                    console.error('Error loading metrics:', error);
                    document.getElementById('totalProjects').textContent = 'Error';
                    document.getElementById('totalElements').textContent = 'Error';
                    document.getElementById('totalViews').textContent = 'Error';
                    document.getElementById('totalWarnings').textContent = 'Error';
                }
            }
            
            // Animate number counting
            function animateNumber(elementId, targetValue) {
                const element = document.getElementById(elementId);
                if (!element) return;
                
                const duration = 2000;
                const startTime = performance.now();
                
                function updateNumber(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                    const currentValue = Math.floor(easeOutQuart * targetValue);
                    
                    element.textContent = currentValue.toLocaleString();
                    
                    if (progress < 1) {
                        requestAnimationFrame(updateNumber);
                    } else {
                        element.textContent = targetValue.toLocaleString();
                    }
                }
                
                requestAnimationFrame(updateNumber);
            }
        });
    </script>
</body>
</html>