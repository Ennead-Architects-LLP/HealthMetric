<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthMetric Dashboard - Ennead Architects</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="asset/icon/ennead_architects_logo.ico">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js?v=20251008_204113"></script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="styles/base.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/layout.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/animations.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/responsive.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/dashboard.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/charts.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/navigation.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/comprehensive-data.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/score-widget.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/score-dashboard.css?v=20251008_204113">
    <link rel="stylesheet" href="styles/components/model-health.css?v=20251008_204113">
    
    <!-- Critical CSS for immediate dark theme rendering -->
    <style>
        /* Prevent white flash on load */
        body {
            background-color: #0a0a0a !important;
            color: #ffffff !important;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="asset/icon/logo.png" alt="Ennead Architects" class="logo-image">
                <span>HealthMetric Dashboard</span>
            </div>
            <div class="nav-actions">
                <div class="filter-status" id="filterStatus">
                    <span class="filter-label">Showing: All Data</span>
                </div>
                <button class="btn btn-secondary" id="backToHero" onclick="navigateToHero()" style="cursor: pointer;">
                    <img src="asset/icon/usage.png" alt="Back" class="icon icon-16 icon-with-text icon-invert">Back to Hero
                </button>
                <button class="btn btn-primary" id="refreshData">
                    <img src="asset/icon/refresh.png" alt="Refresh" class="icon icon-16 icon-with-text">Refresh Data
                </button>
            </div>
            <div class="nav-branding">
                <span class="powered-by">Powered by <strong>EnneadTab</strong></span>
                <span class="work-in-progress"><img src="asset/icon/warning.png" alt="Work In Progress" class="icon icon-16 icon-with-text icon-invert">Work In Progress</span>
            </div>
        </div>
    </nav>

    <!-- Main Dashboard Layout -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>Project Tree</h3>
            </div>
            
            <!-- Project Tree Structure -->
            <div class="filter-section">
                <div class="tree-header">
                    <h4><img src="asset/icon/tree-node.png" alt="Project Tree" class="icon icon-20 icon-with-text">Project Tree</h4>
                    <div class="tree-controls">
                        <button class="tree-control-btn" id="expandAllBtn" title="Expand All">
                            <img src="asset/icon/tree-node.png" alt="Expand All" class="icon icon-12 icon-invert">
                        </button>
                        <button class="tree-control-btn" id="collapseAllBtn" title="Collapse All">
                            <img src="asset/icon/tree-node.png" alt="Collapse All" class="icon icon-12 icon-invert">
                        </button>
                    </div>
                </div>
                <div class="project-tree" id="projectTree">
                    <!-- Project tree will be dynamically generated from SexyDuck data -->
                </div>
            </div>
            
            
            
            <!-- Date Range Filter -->
            <div class="filter-section">
                <h4>Date Range</h4>
                <div class="date-range">
                    <input type="date" id="dateFrom" class="date-input">
                    <input type="date" id="dateTo" class="date-input">
                </div>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Search Bar -->
            <div class="search-section">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search projects, hubs, models..." class="search-input">
                    <button class="search-btn" id="searchBtn"><img src="asset/icon/analyze.png" alt="Search" class="icon icon-16"></button>
                </div>
                <div class="search-filters">
                    <select id="searchType" class="search-select">
                        <option value="all">All</option>
                        <option value="project">Project</option>
                        <option value="hub">Hub</option>
                        <option value="model">Model</option>
                    </select>
                </div>
            </div>
            
            <!-- Dashboard Stats -->
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon"><img src="asset/icon/building.png" alt="Hubs" class="icon icon-24 icon-invert"></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalHubs">-</div>
                        <div class="stat-label">Hubs</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><img src="asset/icon/data.png" alt="Projects" class="icon icon-24 icon-invert"></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalProjects">-</div>
                        <div class="stat-label">Projects</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><img src="asset/icon/usage.png" alt="Models" class="icon icon-24 icon-invert"></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalModels">-</div>
                        <div class="stat-label">Models</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><img src="asset/icon/performance.png" alt="Files" class="icon icon-24"></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalFiles">-</div>
                        <div class="stat-label">Data Files</div>
                    </div>
                </div>
            </div>
            
            <!-- Model Health Scores Section -->
            <div class="model-health-section">
                <div class="section-header">
                    <h3><img src="asset/icon/performance.png" alt="Health Scores" class="icon icon-24 icon-with-text">Model Health Scores</h3>
                    <div class="section-controls">
                        <button class="btn btn-secondary" id="refreshScores">
                            <img src="asset/icon/refresh.png" alt="Refresh" class="icon icon-16 icon-with-text">Refresh Scores
                        </button>
                    </div>
                </div>
                
                <!-- Score Dashboard Container -->
                <div id="score-dashboard" class="score-dashboard-container">
                    <!-- Score widgets will be dynamically generated here -->
                </div>
            </div>
            
            <!-- Comprehensive Data Display -->
            <div class="comprehensive-data-section">
                <h3><img src="asset/icon/performance.png" alt="Analysis" class="icon icon-24 icon-with-text">Detailed Analysis</h3>
                
                <!-- Project Overview -->
                <div class="data-card">
                    <h4><img src="asset/icon/building.png" alt="Project" class="icon icon-20 icon-with-text icon-invert">Project Overview</h4>
                    <div class="project-overview" id="projectOverview">
                        <!-- Project information will be populated here -->
                    </div>
                </div>
                
                <!-- Warning Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/warning.png" alt="Warning" class="icon icon-20 icon-with-text icon-invert">Warning Analysis</h4>
                    <div class="warning-breakdown">
                        <div class="warning-categories" id="warningCategories">
                            <!-- Warning categories will be populated here -->
                        </div>
                        <div class="warning-users" id="warningUsers">
                            <!-- User-specific warnings will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Model Structure -->
                <div class="data-card">
                    <h4><img src="asset/icon/tree-node.png" alt="Structure" class="icon icon-20 icon-with-text icon-invert">Model Structure</h4>
                    <div class="model-structure">
                        <div class="view-breakdown" id="viewBreakdown">
                            <!-- View types breakdown will be populated here -->
                        </div>
                        <div class="element-breakdown" id="elementBreakdown">
                            <!-- Element counts will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Families Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/data.png" alt="Families" class="icon icon-20 icon-with-text icon-invert">Families Analysis</h4>
                    <div class="families-analysis" id="familiesAnalysis">
                        <!-- Families data will be populated here -->
                    </div>
                </div>

                <!-- Group Usage Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/usage.png" alt="Group Usage" class="icon icon-20 icon-with-text icon-invert">Group Usage Analysis</h4>
                    <div class="group-usage" id="groupUsage">
                        <!-- Group usage analysis will be populated here -->
                    </div>
                </div>

                <!-- Templates & Filters -->
                <div class="data-card">
                    <h4><img src="asset/icon/analyze.png" alt="Templates" class="icon icon-20 icon-with-text">Templates & Filters</h4>
                    <div class="templates-filters" id="templatesFilters">
                        <!-- Templates and filters analysis will be populated here -->
                    </div>
                </div>

                <!-- CAD Files Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/download-csv.png" alt="CAD Files" class="icon icon-20 icon-with-text">CAD Files Analysis</h4>
                    <div class="cad-files-analysis" id="cadFilesAnalysis">
                        <!-- CAD files data will be populated here -->
                    </div>
                </div>

                <!-- Rooms Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/tree-node.png" alt="Rooms" class="icon icon-20 icon-with-text">Rooms Analysis</h4>
                    <div class="rooms-analysis" id="roomsAnalysis">
                        <!-- Rooms data will be populated here -->
                    </div>
                </div>

                <!-- Worksets Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/performance.png" alt="Worksets" class="icon icon-20 icon-with-text">Worksets Analysis</h4>
                    <div class="worksets-analysis" id="worksetsAnalysis">
                        <!-- Worksets data will be populated here -->
                    </div>
                </div>

                <!-- Revit Application Version Analysis -->
                <div class="data-card">
                    <h4><img src="asset/icon/building.png" alt="Revit Application Version" class="icon icon-20 icon-with-text">Revit Application Version Analysis</h4>
                    <div class="revit-version-analysis" id="revitVersionAnalysis">
                        <!-- Revit application version data will be populated here -->
                    </div>
                </div>

                
            </div>
            
            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Project Comparison</h3>
                        <div class="chart-controls">
                            <select id="comparisonMetric" class="chart-select">
                                <option value="totalElements">Total Elements</option>
                                <option value="totalViews">Total Views</option>
                                <option value="warningCount">Warnings</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Performance Trends</h3>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="timeSeriesChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Revit Version Distribution</h3>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Elements vs Warnings Correlation</h3>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="scatterChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Data Table -->
            <div class="data-table-section">
                <div class="table-header">
                    <h3>Project Data</h3>
                    <div class="table-controls">
                        <button class="btn btn-secondary" id="exportData"><img src="asset/icon/download-csv.png" alt="Export" class="icon icon-16 icon-with-text">Export CSV</button>
                        <button class="btn btn-secondary" id="printData"><img src="asset/icon/print.png" alt="Print" class="icon icon-16 icon-with-text">Print</button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table" id="dataTable">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="hubName">Hub <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="projectName">Project <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="modelName">Model <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="timestamp">Date <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="totalElements">Elements <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="totalViews">Views <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="warningCount">Warnings <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="executionTime">Exec Time <span class="sort-icon">⇅</span></th>
                                <th class="sortable" data-sort="revitVersion">Revit Version <span class="sort-icon">⇅</span></th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading Dashboard Data...</div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="js/data/DataPlugin.js?v=20251008_204113"></script>
    <script src="js/data/DataLoader.js?v=20251008_204113"></script>
    <script src="js/core/dashboard.js?v=20251008_204113"></script>
    <script src="js/core/dashboard-methods.js?v=20251008_204113"></script>
    <script src="js/core/dashboard-display.js?v=20251008_204113"></script>
    <script src="js/core/dashboard-comprehensive.js?v=20251008_204113"></script>
    <script src="js/components/ScoreWidget.js?v=20251008_204113"></script>
    <script src="js/components/ScoreDashboard.js?v=20251008_204113"></script>
    <script>
        // Initialize dashboard when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            try {
                new DashboardApp();
            } catch (error) {
                console.error('Failed to initialize dashboard:', error);
                // Hide loading screen as fallback
                const overlay = document.getElementById('loadingOverlay');
                if (overlay) {
                    overlay.style.display = 'none';
                }
            }
        });
        
        // Fallback: Hide loading screen after 5 seconds regardless
        setTimeout(() => {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay && overlay.style.display !== 'none') {
                overlay.style.display = 'none';
                console.log('Loading screen hidden by fallback timeout');
            }
        }, 5000);
    </script>
</body>
</html>
